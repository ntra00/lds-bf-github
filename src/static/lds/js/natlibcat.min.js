var begincrumb='<a href="http://www.loc.gov">The Library of Congress</a><span class="crumb-gt"> &gt; </span><a href="/">National Library Catalog (beta)</a><span class="crumb-gt"> &gt; </span>';function setRelLinks(){$("a").click(function(b){var a=$(this).attr("rel");if(a!=null&&a!=""){b.preventDefault();$.address.value(a)}})}function toggleFacetBox(b,a){if(b.text()=="+"){b.text("-")}else{b.text("+")}$("div.content[id="+a+"]").toggle(200)}function initFacetToggles(){$("span.title-toggle > a").each(function(){$(this).toggleClass("hidden");$(this).click(function(b){b.preventDefault();var a=$(this).attr("id");toggleFacetBox($(this),a)})})}function setUpEntityEvents(){$("span.entity","#content").each(function(){$(this).click(function(a){a.preventDefault()})})}function paramVal(e,d){var b=e.indexOf(d+"=");if(b==-1){return""}var c=e.indexOf("&",b);var a=c==-1?e.substring(b):e.substring(b,c);return a.substring(a.indexOf("=")+1)}function setupSearch(){var b=$("#quick-search");var a=$("#quick-search-box");a.autocomplete({minLength:3,source:function(d,e){var c=$("#quick-search-box").val();$.get("/xq/lscoll/suggest.xqy?term="+encodeURIComponent(c),function(f){e(f.split(","))})}});a.keyup(function(c){if(c.keyCode==13){c.preventDefault();b.submit()}});$("#lc-ajax-button").click(function(c){c.preventDefault();b.submit()});b.submit(function(c){c.preventDefault();submitSearchText()})}function fadeAndRemove(a){$(a+" > div").each(function(){$(this).fadeOut(250,function(){$(this).remove()})})}function historyPageInit(){$.address.change(function(b){if(b.value!="/"&&b.value!=""){var a=paramVal(b.value,"page");if((a=="detail")||(a=="results")||(a=="browse")||(a=="search")){$("#ds-results").html("<div style='width:100%;text-align:center;'><img src='/static/natlibcat/images/ajax-loader.gif'/></div>")}$.ajax({type:"GET",url:"/xq/lscoll/parts/ajaxPage.xqy",data:b.value,dataType:"html",success:function(u){$(".ui-autocomplete").remove();$("#ds-body").html($(u).find("#search-results"));setupSearch();if(a=="search"){$("#ds-leftcol").css("visibility","visible");$.address.title("Search (National Library Collections, Library of Congress)")}else{if(a=="results"){$("#ds-leftcol").css("visibility","visible");$("#ds-results").html($(u).find("#results-results"));var l=$.address.path();var n=paramVal(b.value,"q");var r="Search Results (National Library Collections, Library of Congress)";if(n.length>0){var j=r+": "+unescape(paramVal(b.value,"q"))}else{var j=r}$.address.title(j);var g=begincrumb+'<a href="/xq/lscoll/">Search</a><span class="crumb-gt"> &gt; </span><span id="ds-searchcrumb">Search results</span>';$("#crumb_nav").html(g);var f=l.replace(/page=results&/,"");var h=f.replace(/&mime=text\/html/,"");var c='<link id="ds-atomfeed" rel="alternate" href="/xq/lscoll/atom.xqy?'+h+'" type="application/atom+xml" title="National Library Collections Search Results" />';$("#ds-atomfeed").remove();$("head").append(c)}else{if(a=="detail"){$("#ds-leftcol").css("visibility","hidden");$("#ds-results").html($(u).find("#content-results"));var m=$("#title-top").text();var q=$("#backtoresults").attr("href");var i=begincrumb+'<a href="'+q+'">Search results</a><span class="crumb-gt"> &gt; </span><span id="ds-searchcrumb">'+m+"</span>";$("#crumb_nav").html(i);var o="Result (National Library Collections, Library of Congress)";$.address.title(o+": "+m)}else{if(a=="browse"){$("#ds-leftcol").css("visibility","hidden");$("#ds-results").html($(u).find("#ds-browseresults"));var k=paramVal(b.value,"browse");if(k=="class"){var p="classes"}else{var p=k+"s"}var q=$("#backtodetail").attr("href");var d=begincrumb+'<a href="'+q+'">Search results</a><span class="crumb-gt"> &gt; </span><span id="ds-searchcrumb">Browse '+p+"</span>";$("#crumb_nav").html(d);var e="Browse Results (National Library Collections, Library of Congress)";var t=paramVal(b.value,"q");if(t.length>0){var s=e+": "+unescape(t)}else{var s=e}$.address.title(s)}}}}$("#ds-facets").html($(u).find("#facet-results"));initFacetToggles();setRelLinks();$("html, body").animate({scrollTop:0},300);if(a=="results"){$("#ds-hitlist").fadeIn(500)}else{if(a=="detail"){$("#content").fadeIn(500)}}}})}})}function moreNav(b){var c=$(".content","#facybox");var a=$("#facetmorediv",c);$('<div id="replaceme" style="width:795px;text-align:center;"><img src="/static/natlibcat/images/ajax-loader.gif"/></div>').insertAfter(a);a.remove();$.ajax({type:"POST",cache:false,url:b,dataType:"html",success:function(d){$("#replaceme",c).replaceWith($(d))}})}$(document).ready(function(a){historyPageInit()});function sortOrderSel(b){var a=$.address.path();if(b.value=="score-desc"){var c=a.replace(/sort=(score|pubdate|cre)-(asc|desc)/,"sort=score-desc");$.address.path(c)}else{if(b.value=="score-asc"){var c=a.replace(/sort=(score|pubdate|cre)-(asc|desc)/,"sort=score-asc");$.address.path(c)}else{if(b.value=="cre-desc"){var c=a.replace(/sort=(score|pubdate|cre)-(asc|desc)/,"sort=cre-desc");$.address.path(c)}else{if(b.value=="cre-asc"){var c=a.replace(/sort=(score|pubdate|cre)-(asc|desc)/,"sort=cre-asc");$.address.path(c)}else{if(b.value=="pubdate-asc"){var c=a.replace(/sort=(score|pubdate|cre)-(asc|desc)/,"sort=pubdate-asc");$.address.path(c)}else{if(b.value=="pubdate-desc"){var c=a.replace(/sort=(score|pubdate|cre)-(asc|desc)/,"sort=pubdate-desc");$.address.path(c)}else{var c=a.replace(/sort=.+/,"sort=score-desc");$.address.path(c)}}}}}}}function numHitsSel(b){var a=$.address.path();if(b.value=="hits25"){var c=a.replace(/count=\d*/,"count=25");$.address.path(c)}else{if(b.value=="hits10"){var c=a.replace(/count=\d*/,"count=10");$.address.path(c)}else{var c=a.replace(/count=\d*/,"count=10");$.address.path(c)}}}function submitSearchText(){var f=$("#quick-search-box");var c=f.attr("rel");var b=f.val();if(b.length==0||b=="Enter search word(s)"){var a=$.address.path();var e=a.replace(/page=search/,"page=results");$.address.path(e)}else{var d=c+"&q="+b;$.address.value(d)}}var clearSearchBox=function(c){var a="#"+c;var b=$(a).attr("value");if(b=="Enter search word(s)"){$(a).attr("value","")}};function showSearchOptions(){if(document.getElementById("searchOptionsContainer").style.display==""||document.getElementById("searchOptionsContainer").style.display=="none"){document.getElementById("errorMsg1").innerHTML="";document.getElementById("errorMsg1").style.display="none";document.getElementById("subTabSearchHelpText").style.display="none";document.getElementById("searchOptionsContainer").style.display="block";$("#limits-mover").toggleClass("limits-container-move");$("#newOptionsMenu").attr("src","/static/natlibcat/images/bg_options-up.gif")}else{document.getElementById("searchOptionsContainer").style.display="none";document.getElementById("errorMsg1").innerHTML="";document.getElementById("errorMsg1").style.display="block";document.getElementById("subTabSearchHelpText").style.display="block";$("#limits-mover").toggleClass("limits-container-move");$("#newOptionsMenu").attr("src","/static/natlibcat/images/bg_options.gif")}}function suggester(b){var a=$.address.path();if(b=="idx:mainCreator"||b=="idx:titleLexicon"||b=="idx:subjectLexicon"){$.address.path(a+"&qname="+b)}else{return null}}function mainPageSuggester(b){if(b=="keyword"){return null}else{var a=$("#quick-search-box");a.autocomplete({minLength:3,source:function(d,e){var c=$("#quick-search-box").val();$.get("/xq/lscoll/suggest.xqy?qname="+b+"&term="+encodeURIComponent(c),function(f){e(f.split(","))})}})}}function fieldedSel(d){var b=$.address.path();var c=$("#quick-search-box").val();if(c.length!==0&&c!=="Enter search word(s)"){var a=encodeURIComponent(c);if(d.value=="keyword"){var e=b.replace(/qname=.+/,"qname=keyword&q="+a);$.address.path(e)}else{if(d.value=="idx:mainCreator"){var e=b.replace(/qname=.+/,"qname=idx:mainCreator&q="+a);$.address.path(e)}else{if(d.value=="idx:subjectLexicon"){var e=b.replace(/qname=.+/,"qname=idx:subjectLexicon&q="+a);$.address.path(e)}else{if(d.value=="idx:titleLexicon"){var e=b.replace(/qname=.+/,"qname=idx:titleLexicon&q="+a);$.address.path(e)}else{var e=b.replace(/qname=.+/,"qname=keyword&q="+a);$.address.path(e)}}}}}};